<section class="edit-section" id="template_clip_pannel">
	<div class="righ_title">
		<i class="fa fa-edit"></i><span class="text">图片视频编辑</span>
	</div>
	<ul class="navbar">
		<li class="nav-item">
			<a class="nav-link" href="javascript:void(0);" data-toggle="true"><i class="fa fa-image"></i><span>上传图片</span></a>
			<div class="subnav">

				<div class="clearfix">
					<div class="fileBar" id="fileBar">
						<div class="fileProgress"></div>
					</div>
					<div id="uploaderContainer" class="webuploader-container">
						<div class="webuploader-pick">选择文件</div>
						<div id="uploadFileContainer">
							<input type="file" name="file" multiple="multiple">
							<label></label>
						</div>
					</div>
					<div class="file-bottom" style="display:none;">
						<a href="javascript:;" class="btn">确定</a>
					</div>
				</div>


				<div class="image-all">
					<ul class="imgul">
						<li><img src="/static/poster_pc/images/system-img1.png"/></li>
						<li><img src="/static/poster_pc/images/system-img2.png"/></li>
						<li><img src="/static/poster_pc/images/system-img1.png"/></li>
						<li><img src="/static/poster_pc/images/system-img2.png"/></li>
						<li><img src="/static/poster_pc/images/system-img1.png"/></li>
						<li><img src="/static/poster_pc/images/system-img2.png"/></li>
						<li><img src="/static/poster_pc/images/system-img1.png"/></li>
						<li><img src="/static/poster_pc/images/system-img2.png"/></li>
						<li><img src="/static/poster_pc/images/system-img1.png"/></li>
					</ul>

				</div>


			</div>

		</li>

		<li class="nav-item">
			<a class="nav-link" href="javascript:void(0);" data-toggle="true"><i class="fa fa-video-camera"></i><span>上传视频</span></a>
			<div class="subnav">
			<ul class="parentImgUL">

			</ul>
				<div id="uploadsvideo1">上传视频</div>
			</div>
		</li>
		<li class="nav-item">
			<a class="nav-link" href="javascript:void(0);" data-toggle="true"><i class="fa fa-chain"></i><span>图片视频链接</span></a>
			<div class="subnav">

				<div class="link-body"><div class="link-body-inner"></div></div>
				<div class="link-input">
					<div class="input-group">
						<input type="text" class="form-control input-lg" id="resourceLinkText" placeholder="请输入图片或视频链接">
						<span class="input-group-btn">
							<button class="btn btn-default btn-lg" type="button" id="resourceLinkBtn">
								<span class="fa fa-chain"></span>
							</button>
						</span>
					</div>
				</div>

			</div>
		</li>
	</ul>
</section>

<script type="text/javascript">

	var slideTarget;
	  $('#uploaderContainer').diyUpload({
			url: '/api/v1/poster/upload/logo',
			buttonText: '上传图片',
			chunked: false,
			fileNumLimit: 4,
			fileSingleSizeLimit: 5 * 1024 * 1024,
			accept: {
				title: 'Images',
				extensions: 'gif,jpg,jpeg,png',
				mimeTypes: 'image/*'
			},
			compress: false,
			threads: 1,
			auto: true,
			success: function(data, file) {
				var target = Editor.require("hightClick").getCurrentTarget();
				slideTarget = $(target);
				//console.log(target);
				data.imgid = file.id;
				$(target).imgslider({"data":data});
				$(target).imgoperation();

			},
			error: function(err) {
				console.info(err);
			},
		  	sliderContainer:slideTarget

		});


		$("#uploadsvideo1").click(function(){
			$.fn.uploadsvideo.showDialog(function(data) {
				var target = Editor.require("hightClick").getCurrentTarget();
				console.log(data);
				var vediobtn = $('<a class="video-js">' +
						'<img src="/static/poster_pc/images/play.png" class="video-play"/>' +
						'</a>');
				$("#uploadsvideo1").before(vediobtn);
				target.empty().append(vediobtn);
				//var videoplay = $(".video-play");
				$("#video_1").find("video").attr("poster",data.preview);
				vediobtn.find('.video-play').on('click',function(){
					$("#video_1").find("video").attr("src",data.file);
					$(".introVideoDialog").show();


				});
		/*
		$("#videoDomTmpl").tmpl({
			"class_name": "video_content",
			"video_dom_id": data.id,
			"video_id": data.id,
			"video_preview_img": data.preview,
			"video_url": data.file
		}).appendTo(target);

		videojs.initialize('video_' + data.id);
		*/


	}, function(data) {
			yyAlert("上传失败");
		});

		getVideos();
		})

		getVideos();
		function getVideos(){
		$.ajax({
			url: "/api/v1/account/files?q=video",
			type: "get",
			datatype: "json",
			success: function(data) {
				$(".parentImgUL").empty();
				$.each(data, function(){
					var li = $(' <li data-src="'+this.file+'"><img src="' + this.preview + '"/><img src="/static/poster_pc/images/play.png" class="video-play"/></li>')
					$(".parentImgUL").append(li);
					li.click(function(){
						$("#video_1").find("video").attr("src",$(this).attr('data-src'));
						$(".introVideoDialog").show();
					})
				 });



			}
		});
		}




</script>